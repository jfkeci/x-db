---
import { Image } from 'astro:assets';
import { getCollection } from 'astro:content';
import BaseHead from '../../components/BaseHead.astro';
import Footer from '../../components/Footer.astro';
import FormattedDate from '../../components/FormattedDate.astro';
import Header from '../../components/Header.astro';
import { SITE_DESCRIPTION, SITE_TITLE } from '../../consts';

const posts = (await getCollection('blog')).sort(
	(a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf(),
);
---

<!doctype html>
<html lang="en">
	<head>
		<BaseHead title={`Blog | ${SITE_TITLE}`} description={SITE_DESCRIPTION} />
	</head>
	<body class="min-h-screen bg-gradient-to-br from-purple-700 via-pink-600 to-orange-500 dark:from-gray-900 dark:via-purple-900 dark:to-gray-900 transition-colors duration-500">
		<!-- Animated background blobs -->
		<div class="fixed inset-0 overflow-hidden pointer-events-none">
			<div class="absolute -top-40 -left-40 w-80 h-80 bg-purple-400 dark:bg-purple-600 rounded-full mix-blend-multiply dark:mix-blend-soft-light filter blur-3xl opacity-70 animate-blob"></div>
			<div class="absolute top-40 -right-40 w-80 h-80 bg-yellow-300 dark:bg-pink-600 rounded-full mix-blend-multiply dark:mix-blend-soft-light filter blur-3xl opacity-70 animate-blob animation-delay-2000"></div>
			<div class="absolute -bottom-40 left-1/2 w-80 h-80 bg-pink-400 dark:bg-blue-600 rounded-full mix-blend-multiply dark:mix-blend-soft-light filter blur-3xl opacity-70 animate-blob animation-delay-4000"></div>
		</div>

		<Header />

		<div class="relative z-10 max-w-5xl mx-auto px-4 pt-24 pb-12">
			<div class="text-center mb-12">
				<h1 class="text-4xl md:text-5xl font-bold text-white mb-4 drop-shadow-lg">Blog</h1>
				<p class="text-lg text-white/80">Tips, guides, and insights for your fitness journey</p>
			</div>

			<div class="grid gap-8">
				{posts.map((post, index) => (
					<article class={`glass-card rounded-3xl overflow-hidden hover:scale-[1.01] transition-all duration-300 ${index === 0 ? 'md:flex' : ''}`}>
						{post.data.heroImage && (
							<div class={`${index === 0 ? 'md:w-1/2' : ''}`}>
								<Image
									width={720}
									height={360}
									src={post.data.heroImage}
									alt=""
									class="w-full h-48 md:h-full object-cover"
								/>
							</div>
						)}
						<div class={`p-6 ${index === 0 ? 'md:w-1/2 md:flex md:flex-col md:justify-center' : ''}`}>
							<div class="flex items-center gap-3 mb-3">
								<span class="glass px-3 py-1 rounded-full text-xs font-medium text-white/80">
									Article
								</span>
								<span class="text-white/50 text-sm">
									<FormattedDate date={post.data.pubDate} />
								</span>
							</div>
							<a href={`/blog/${post.id}/`} class="group">
								<h2 class={`font-bold text-white mb-3 group-hover:text-white/90 transition-colors ${index === 0 ? 'text-2xl md:text-3xl' : 'text-xl'}`}>
									{post.data.title}
								</h2>
							</a>
							<p class="text-white/70 mb-4 line-clamp-2">
								{post.data.description}
							</p>
							<a
								href={`/blog/${post.id}/`}
								class="inline-flex items-center gap-2 text-white font-medium hover:gap-3 transition-all"
							>
								Read more
								<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
									<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3"></path>
								</svg>
							</a>
						</div>
					</article>
				))}
			</div>
		</div>

		<Footer />

		<style>
			@keyframes blob {
				0% { transform: translate(0px, 0px) scale(1); }
				33% { transform: translate(30px, -50px) scale(1.1); }
				66% { transform: translate(-20px, 20px) scale(0.9); }
				100% { transform: translate(0px, 0px) scale(1); }
			}
			.animate-blob {
				animation: blob 7s infinite;
			}
			.animation-delay-2000 {
				animation-delay: 2s;
			}
			.animation-delay-4000 {
				animation-delay: 4s;
			}
		</style>
	</body>
</html>
